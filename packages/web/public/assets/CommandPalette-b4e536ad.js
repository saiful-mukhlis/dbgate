import{v as oe,w as O,x as le,y as pe,S as ge,i as he,s as ke,F as q,z as X,A as L,B as J,C as Q,D as K,G as I,H as N,I as G,J as y,K as R,L as Y,l as M,M as ye,N as Ce,O as P,P as re,Q as E,R as H,T as W,U as ve,V as we,c as U,o as Ie,W as De,X as Se,Y as ie,n as Z,e as x,a as ce,Z as Le,_ as j,$ as A,a0 as $,a1 as ee,a2 as ze,a3 as Oe,a4 as Pe,a5 as Te,a6 as Ee,a7 as Be,a8 as Fe}from"./index-632e4f1b.js";import"./dbgate-datalib-0d3b84db.js";import{g as je,_ as B}from"./lodash-29c9ec56.js";var ue={exports:{}};(function(e,s){(function(){var t={};e.exports=t,t.simpleFilter=function(n,a){return a.filter(function(l){return t.test(n,l)})},t.test=function(n,a){return t.match(n,a)!==null},t.match=function(n,a,l){l=l||{};var c=0,u=[],b=a.length,_=0,g=0,f=l.pre||"",d=l.post||"",r=l.caseSensitive&&a||a.toLowerCase(),D;n=l.caseSensitive&&n||n.toLowerCase();for(var w=0;w<b;w++)D=a[w],r[w]===n[c]?(D=f+D+d,c+=1,g+=1+g):g=0,_+=g,u[u.length]=D;return c===n.length?(_=r===n?1/0:_,{rendered:u.join(""),score:_}):null},t.filter=function(n,a,l){return!a||a.length===0?[]:typeof n!="string"?a:(l=l||{},a.reduce(function(c,u,b,_){var g=u;l.extract&&(g=l.extract(u));var f=t.match(n,g,l);return f!=null&&(c[c.length]={string:f.rendered,score:f.score,index:b,original:u}),c},[]).sort(function(c,u){var b=u.score-c.score;return b||c.index-u.index}))}})()})(ue);var Ae=ue.exports;const Me=je(Ae);function te(e,s,t){const n=e.slice();return n[25]=s[t],n[26]=s,n[27]=t,n}function ne(e){let s,t,n;return t=new q({props:{icon:e[25].icon}}),{c(){s=L("span"),J(t.$$.fragment),I(s,"class","mr-1")},m(a,l){G(a,s,l),R(t,s,null),n=!0},p(a,l){const c={};l&64&&(c.icon=a[25].icon),t.$set(c)},i(a){n||(P(t.$$.fragment,a),n=!0)},o(a){E(t.$$.fragment,a),n=!1},d(a){a&&H(s),W(t)}}}function ae(e){let s,t=ee(e[25].keyText)+"",n;return{c(){s=L("div"),n=Q(t),I(s,"class","shortcut svelte-1kyrubd")},m(a,l){G(a,s,l),y(s,n)},p(a,l){l&64&&t!==(t=ee(a[25].keyText)+"")&&ze(n,t)},d(a){a&&H(s)}}}function se(e){let s,t,n,a,l=e[25].text+"",c,u,b=e[27],_,g,f,d=e[25].icon&&ne(e),r=e[25].keyText&&ae(e);function D(){return e[22](e[25])}const w=()=>e[23](s,b),S=()=>e[23](null,b);return{c(){s=L("div"),t=L("div"),d&&d.c(),n=K(),a=new Oe(!1),c=K(),r&&r.c(),u=K(),a.a=null,I(s,"class","command svelte-1kyrubd"),N(s,"selected",e[27]==e[2])},m(h,C){G(h,s,C),y(s,t),d&&d.m(t,null),y(t,n),a.m(l,t),y(s,c),r&&r.m(s,null),y(s,u),w(),_=!0,g||(f=M(s,"click",D),g=!0)},p(h,C){e=h,e[25].icon?d?(d.p(e,C),C&64&&P(d,1)):(d=ne(e),d.c(),P(d,1),d.m(t,n)):d&&(ie(),E(d,1,1,()=>{d=null}),re()),(!_||C&64)&&l!==(l=e[25].text+"")&&a.p(l),e[25].keyText?r?r.p(e,C):(r=ae(e),r.c(),r.m(s,u)):r&&(r.d(1),r=null),b!==e[27]&&(S(),b=e[27],w()),(!_||C&4)&&N(s,"selected",e[27]==e[2])},i(h){_||(P(d),_=!0)},o(h){E(d),_=!1},d(h){h&&H(s),d&&d.d(),r&&r.d(),S(),g=!1,f()}}}function Ne(e){let s,t,n,a,l,c,u,b,_,g,f,d,r,D,w,S,h,C,F;a=new q({props:{icon:"icon menu"}}),b=new q({props:{icon:"icon database"}});let v=X(e[6]),m=[];for(let i=0;i<v.length;i+=1)m[i]=se(te(e,v,i));const T=i=>E(m[i],1,1,()=>{m[i]=null});return{c(){var i;s=L("div"),t=L("div"),n=L("div"),J(a.$$.fragment),l=Q(" Commands"),c=K(),u=L("div"),J(b.$$.fragment),_=Q(" Database"),g=K(),f=L("div"),d=L("div"),r=L("input"),w=K(),S=L("div");for(let p=0;p<m.length;p+=1)m[p].c();I(n,"class","page svelte-1kyrubd"),N(n,"selected",e[4]=="menu"),I(u,"class","page svelte-1kyrubd"),N(u,"selected",e[4]=="database"),I(t,"class","pages svelte-1kyrubd"),I(r,"type","text"),I(r,"placeholder",D=((i=e[3])==null?void 0:i.text)||(e[4]=="database"?"Search in database":"Search in commands")),I(r,"class","svelte-1kyrubd"),I(d,"class","search svelte-1kyrubd"),I(S,"class","content svelte-1kyrubd"),I(f,"class","mainInner svelte-1kyrubd"),I(s,"class","main svelte-1kyrubd")},m(i,p){G(i,s,p),y(s,t),y(t,n),R(a,n,null),y(n,l),y(t,c),y(t,u),R(b,u,null),y(u,_),y(s,g),y(s,f),y(f,d),y(d,r),e[20](r),Y(r,e[0]),y(f,w),y(f,S);for(let z=0;z<m.length;z+=1)m[z]&&m[z].m(S,null);h=!0,C||(F=[M(n,"click",e[18]),M(u,"click",e[19]),M(r,"input",e[21]),M(r,"keydown",e[10]),ye(Ce.call(null,s)),M(s,"clickOutside",e[24])],C=!0)},p(i,[p]){var z;if((!h||p&16)&&N(n,"selected",i[4]=="menu"),(!h||p&16)&&N(u,"selected",i[4]=="database"),(!h||p&24&&D!==(D=((z=i[3])==null?void 0:z.text)||(i[4]=="database"?"Search in database":"Search in commands")))&&I(r,"placeholder",D),p&1&&r.value!==i[0]&&Y(r,i[0]),p&582){v=X(i[6]);let k;for(k=0;k<v.length;k+=1){const V=te(i,v,k);m[k]?(m[k].p(V,p),P(m[k],1)):(m[k]=se(V),m[k].c(),P(m[k],1),m[k].m(S,null))}for(ie(),k=v.length;k<m.length;k+=1)T(k);re()}},i(i){if(!h){P(a.$$.fragment,i),P(b.$$.fragment,i);for(let p=0;p<v.length;p+=1)P(m[p]);h=!0}},o(i){E(a.$$.fragment,i),E(b.$$.fragment,i),m=m.filter(Boolean);for(let p=0;p<m.length;p+=1)E(m[p]);h=!1},d(i){i&&H(s),W(a),W(b),e[20](null),ve(m,i),C=!1,we(F)}}}oe({id:"commandPalette.show",category:"Command palette",name:"Show",toolbarName:"Command palette",toolbarOrder:0,keyText:"F1",toolbar:!0,showDisabled:!0,icon:"icon menu",onClick:()=>O.set("menu"),testEnabled:()=>le()!="menu"});oe({id:"database.search",category:"Database",toolbarName:"Database search",name:"Search",keyText:pe()?"CtrlOrCommand+P":"F3",onClick:()=>O.set("database"),testEnabled:()=>le()!="database"});function Ke(e,s,t){var l;const n=B.flatten(["tables","collections","views","matviews","procedures","functions"].map(c=>B.sortBy(((e||{})[c]||[]).map(u=>({text:u.pureName,onClick:()=>Pe({objectTypeField:c,...s,...u}),icon:Te[c]})),["text"]))),a=[];for(const c of t||[]){const u=c._id;if(c.singleDatabase||(l=Fe())!=null&&l.singleDbConnection)continue;const b=Ee(`database_list_${u}`)||[];for(const _ of b)a.push({text:`${_.name} on ${Be(c)}`,icon:"img database",onClick:()=>ce.set({connection:c,name:_.name})})}return[...B.sortBy(a,"text"),...n]}function Ve(e,s,t){let n,a,l,c,u,b,_,g,f,d,r=Z,D=()=>(r(),r=x(_,o=>t(14,d=o)),_),w,S=Z,h=()=>(S(),S=x(b,o=>t(15,w=o)),b),C,F;U(e,O,o=>t(4,f=o)),U(e,ce,o=>t(16,C=o)),U(e,Le,o=>t(17,F=o)),e.$$.on_destroy.push(()=>r()),e.$$.on_destroy.push(()=>S());let v,m="";const T={};Ie(()=>{const o=document.activeElement;return v.focus(),()=>{o&&o.focus()}});function i(o){o.getSubCommands?(j(O,f=o,f),v.focus(),t(0,m=""),t(2,n=0)):(j(O,f=null,f),o.onClick())}function p(o){o.keyCode==A.upArrow&&n>0&&t(2,n--,n),o.keyCode==A.downArrow&&n<g.length-1&&t(2,n++,n),o.keyCode==A.enter&&(o.preventDefault(),o.stopPropagation(),i(g[n])),o.keyCode==A.escape&&j(O,f=null,f),o.keyCode==A.pageDown&&t(2,n=Math.min(n+15,g.length-1)),o.keyCode==A.pageUp&&t(2,n=Math.max(n-15,0))}const z=()=>{j(O,f="menu",f),v.focus()},k=()=>{j(O,f="database",f),v.focus()};function V(o){$[o?"unshift":"push"](()=>{v=o,t(5,v)})}function fe(){m=this.value,t(0,m)}const de=o=>i(o);function me(o,_e){$[o?"unshift":"push"](()=>{T[_e]=o,t(1,T)})}const be=()=>{j(O,f=null,f)};return e.$$.update=()=>{e.$$.dirty&1&&t(2,n=0),e.$$.dirty&16&&t(3,a=B.isPlainObject(f)?f:null),e.$$.dirty&131072&&t(11,l=B.sortBy(Object.values(F).filter(o=>o.enabled),"text")),e.$$.dirty&65536&&t(13,c=B.get(C,"connection._id")),e.$$.dirty&65536&&t(12,u=B.get(C,"name")),e.$$.dirty&12288&&h(t(8,b=De({conid:c,database:u}))),e.$$.dirty&63513&&t(6,g=Me.filter(m,(f=="database"?Ke(w,{conid:c,database:u},d):a?a.getSubCommands():l).filter(o=>!o.isGroupCommand),{extract:o=>o.text,pre:"<b>",post:"</b>"}).map(o=>({...o.original,text:o.string}))),e.$$.dirty&6&&T[n]&&T[n].scrollIntoView({block:"nearest",inline:"nearest"})},D(t(7,_=Se())),[m,T,n,a,f,v,g,_,b,i,p,l,u,c,d,w,C,F,z,k,V,fe,de,me,be]}class qe extends ge{constructor(s){super(),he(this,s,Ve,Ne,ke,{})}}export{qe as default};
//# sourceMappingURL=CommandPalette-b4e536ad.js.map
