{"version":3,"file":"QueryHistoryList-d359c5c7.js","sources":["../../src/widgets/QueryHistoryList.svelte"],"sourcesContent":["<script lang=\"ts\">\n  import _ from 'lodash';\n\n  import SearchBoxWrapper from '../elements/SearchBoxWrapper.svelte';\n  import SearchInput from '../elements/SearchInput.svelte';\n  import WidgetsInnerContainer from '../widgets/WidgetsInnerContainer.svelte';\n  import FontIcon from '../icons/FontIcon.svelte';\n  import { onMount } from 'svelte';\n  import openNewTab from '../utility/openNewTab';\n  import CloseSearchButton from '../buttons/CloseSearchButton.svelte';\n  import { apiCall, apiOff, apiOn } from '../utility/api';\n\n  let filter = '';\n  let search = '';\n\n  let historyItems = [];\n\n  async function reloadItems() {\n    const resp = await apiCall('query-history/read', { filter: search, limit: 100 });\n    historyItems = resp;\n  }\n\n  $: {\n    search;\n    reloadItems();\n  }\n\n  const setDebouncedFilter = _.debounce(value => (search = value), 500);\n\n  $: setDebouncedFilter(filter);\n\n  onMount(() => {\n    apiOn('query-history-changed', reloadItems);\n    return () => {\n      apiOff('query-history-changed', reloadItems);\n    };\n  });\n</script>\n\n<SearchBoxWrapper>\n  <SearchInput placeholder=\"Search query history\" {filter} bind:value={filter} />\n  <CloseSearchButton\n    bind:filter\n    on:click={() => {\n      search = '';\n    }}\n  />\n</SearchBoxWrapper>\n<WidgetsInnerContainer>\n  {#each historyItems as item}\n    <div\n      class=\"wrapper\"\n      title={item.sql}\n      on:click={() => {\n        openNewTab(\n          {\n            title: 'Query #',\n            icon: 'icon sql-file',\n            tabComponent: 'QueryTab',\n            props: {\n              conid: item.conid,\n              database: item.database,\n            },\n          },\n          { editor: item.sql }\n        );\n      }}\n    >\n      <div class=\"sql\">\n        <FontIcon icon=\"icon sql-file\" />\n        {item.sql}\n      </div>\n      <div class=\"info\">\n        <FontIcon icon=\"icon database\" />\n        {item.database}\n      </div>\n    </div>\n  {/each}\n</WidgetsInnerContainer>\n\n<style>\n  .wrapper {\n    padding: 5px;\n  }\n  .wrapper:hover {\n    background-color: var(--theme-bg-hover);\n  }\n  .info {\n    margin-left: 30px;\n    margin-top: 5px;\n    color: var(--theme-font-3);\n  }\n  .sql {\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n  }\n</style>\n"],"names":["ctx","t1_value","t4_value","attr","div2","div2_title_value","insert","target","anchor","append","div0","div1","current","dirty","set_data","t1","t4","i","each_blocks","__awaiter","thisArg","_arguments","P","generator","filter","value","$$invalidate","search","openNewTab","item"],"mappings":"6hBAwCuEA,EAAM,CAAA,IAAA,iBAANA,EAAM,CAAA,6UAANA,EAAM,CAAA,uPA8BpEC,EAAAD,MAAK,IAAG,aAIRE,EAAAF,MAAK,SAAQ,2VAtBTG,EAAAC,EAAA,QAAAC,EAAAL,MAAK,GAAG,UAFjBM,EA0BKC,EAAAH,EAAAI,CAAA,EARHC,EAGKL,EAAAM,CAAA,mCACLD,EAGKL,EAAAO,CAAA,iFALF,CAAAC,GAAAC,EAAA,IAAAZ,KAAAA,EAAAD,MAAK,IAAG,KAAAc,EAAAC,EAAAd,CAAA,GAIR,CAAAW,GAAAC,EAAA,IAAAX,KAAAA,EAAAF,MAAK,SAAQ,KAAAc,EAAAE,EAAAd,CAAA,GAtBT,CAAAU,GAAAC,EAAA,GAAAR,KAAAA,EAAAL,MAAK,2LAHTA,EAAY,CAAA,CAAA,uBAAjB,OAAIiB,GAAA,wMAACjB,EAAY,CAAA,CAAA,oBAAjB,OAAIiB,GAAA,EAAA,kHAAJ,OAAIA,EAAAC,EAAA,OAAAD,GAAA,0CAAJ,OAAIA,GAAA,0mBAjDS,IAAAE,EAAA,MAAA,KAAA,WAAA,SAAAC,EAAAC,EAAAC,EAAAC,EAAA,0iBAwCsDC,EAAMC,+CAIvEC,EAAA,EAAAC,EAAS,EAAE,SAUTC,IAEI,MAAO,UACP,KAAM,gBACN,aAAc,WACd,MAAK,CACH,MAAOC,EAAK,MACZ,SAAUA,EAAK,YAGjB,OAAQA,EAAK,GAAG"}