import{S as M,i as R,s as U,ai as X,aj as E,B as C,D as k,K as I,I as F,O as $,Q as b,R as O,T as S,o as V,al as Z,a0 as L,am as N,an as P,aq as W,z as Y,aF as x,Y as ee,P as te,U as ne,af as se,aX as ae,aY as re,m as ie,F as j,A as H,C as z,G as Q,J as g,l as oe,a2 as A}from"./index-632e4f1b.js";import{_ as le}from"./lodash-29c9ec56.js";import"./dbgate-datalib-0d3b84db.js";function G(r,n,l){const i=r.slice();return i[10]=n[l],i}function fe(r){let n,l,i,e,a,t;function f(o){r[3](o)}let s={placeholder:"Search query history",filter:r[0]};r[0]!==void 0&&(s.value=r[0]),n=new Z({props:s}),L.push(()=>N(n,"value",f));function p(o){r[4](o)}let v={};return r[0]!==void 0&&(v.filter=r[0]),e=new P({props:v}),L.push(()=>N(e,"filter",p)),e.$on("click",r[5]),{c(){C(n.$$.fragment),i=k(),C(e.$$.fragment)},m(o,_){I(n,o,_),F(o,i,_),I(e,o,_),t=!0},p(o,_){const c={};_&1&&(c.filter=o[0]),!l&&_&1&&(l=!0,c.value=o[0],W(()=>l=!1)),n.$set(c);const h={};!a&&_&1&&(a=!0,h.filter=o[0],W(()=>a=!1)),e.$set(h)},i(o){t||($(n.$$.fragment,o),$(e.$$.fragment,o),t=!0)},o(o){b(n.$$.fragment,o),b(e.$$.fragment,o),t=!1},d(o){o&&O(i),S(n,o),S(e,o)}}}function J(r){let n,l,i,e,a=r[10].sql+"",t,f,s,p,v,o=r[10].database+"",_,c,h,d,m,B;i=new j({props:{icon:"icon sql-file"}}),p=new j({props:{icon:"icon database"}});function y(){return r[6](r[10])}return{c(){n=H("div"),l=H("div"),C(i.$$.fragment),e=k(),t=z(a),f=k(),s=H("div"),C(p.$$.fragment),v=k(),_=z(o),c=k(),Q(l,"class","sql svelte-fyr7t5"),Q(s,"class","info svelte-fyr7t5"),Q(n,"class","wrapper svelte-fyr7t5"),Q(n,"title",h=r[10].sql)},m(u,w){F(u,n,w),g(n,l),I(i,l,null),g(l,e),g(l,t),g(n,f),g(n,s),I(p,s,null),g(s,v),g(s,_),g(n,c),d=!0,m||(B=oe(n,"click",y),m=!0)},p(u,w){r=u,(!d||w&4)&&a!==(a=r[10].sql+"")&&A(t,a),(!d||w&4)&&o!==(o=r[10].database+"")&&A(_,o),(!d||w&4&&h!==(h=r[10].sql))&&Q(n,"title",h)},i(u){d||($(i.$$.fragment,u),$(p.$$.fragment,u),d=!0)},o(u){b(i.$$.fragment,u),b(p.$$.fragment,u),d=!1},d(u){u&&O(n),S(i),S(p),m=!1,B()}}}function ce(r){let n,l,i=Y(r[2]),e=[];for(let t=0;t<i.length;t+=1)e[t]=J(G(r,i,t));const a=t=>b(e[t],1,1,()=>{e[t]=null});return{c(){for(let t=0;t<e.length;t+=1)e[t].c();n=x()},m(t,f){for(let s=0;s<e.length;s+=1)e[s]&&e[s].m(t,f);F(t,n,f),l=!0},p(t,f){if(f&4){i=Y(t[2]);let s;for(s=0;s<i.length;s+=1){const p=G(t,i,s);e[s]?(e[s].p(p,f),$(e[s],1)):(e[s]=J(p),e[s].c(),$(e[s],1),e[s].m(n.parentNode,n))}for(ee(),s=i.length;s<e.length;s+=1)a(s);te()}},i(t){if(!l){for(let f=0;f<i.length;f+=1)$(e[f]);l=!0}},o(t){e=e.filter(Boolean);for(let f=0;f<e.length;f+=1)b(e[f]);l=!1},d(t){t&&O(n),ne(e,t)}}}function ue(r){let n,l,i,e;return n=new X({props:{$$slots:{default:[fe]},$$scope:{ctx:r}}}),i=new E({props:{$$slots:{default:[ce]},$$scope:{ctx:r}}}),{c(){C(n.$$.fragment),l=k(),C(i.$$.fragment)},m(a,t){I(n,a,t),F(a,l,t),I(i,a,t),e=!0},p(a,[t]){const f={};t&8195&&(f.$$scope={dirty:t,ctx:a}),n.$set(f);const s={};t&8196&&(s.$$scope={dirty:t,ctx:a}),i.$set(s)},i(a){e||($(n.$$.fragment,a),$(i.$$.fragment,a),e=!0)},o(a){b(n.$$.fragment,a),b(i.$$.fragment,a),e=!1},d(a){a&&O(l),S(n,a),S(i,a)}}}function pe(r,n,l){var i=this&&this.__awaiter||function(c,h,d,m){function B(y){return y instanceof d?y:new d(function(u){u(y)})}return new(d||(d=Promise))(function(y,u){function w(q){try{T(m.next(q))}catch(D){u(D)}}function K(q){try{T(m.throw(q))}catch(D){u(D)}}function T(q){q.done?y(q.value):B(q.value).then(w,K)}T((m=m.apply(c,h||[])).next())})};let e="",a="",t=[];function f(){return i(this,void 0,void 0,function*(){const c=yield se("query-history/read",{filter:a,limit:100});l(2,t=c)})}const s=le.debounce(c=>l(1,a=c),500);V(()=>(ae("query-history-changed",f),()=>{re("query-history-changed",f)}));function p(c){e=c,l(0,e)}function v(c){e=c,l(0,e)}const o=()=>{l(1,a="")},_=c=>{ie({title:"Query #",icon:"icon sql-file",tabComponent:"QueryTab",props:{conid:c.conid,database:c.database}},{editor:c.sql})};return r.$$.update=()=>{r.$$.dirty&2&&f(),r.$$.dirty&1&&s(e)},[e,a,t,p,v,o,_]}class $e extends M{constructor(n){super(),R(this,n,pe,ue,U,{})}}export{$e as default};
//# sourceMappingURL=QueryHistoryList-d359c5c7.js.map
