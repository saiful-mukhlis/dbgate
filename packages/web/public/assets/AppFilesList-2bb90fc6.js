import{S as P,i as U,s as Y,a9 as R,aa as Z,B as y,K as T,ab as ee,ac as te,O as v,Q as j,T as C,ad as x,ae as ne,af as L,m as ae,j as W,ag as G,ah as ie,ai as oe,aj as se,D as O,I as Q,R as M,c as re,ak as le,al as ce,a0 as B,am as D,an as fe,ao as pe,ap as ue,aq as J,ar as de,n as H,e as me,as as he,F as _e,at as $e,au as be}from"./index-632e4f1b.js";import{l as we}from"./dbgate-datalib-0d3b84db.js";import"./lodash-29c9ec56.js";function ge(a){let t,i;const n=[a[3],{data:a[0]},{title:a[0].fileLabel},{icon:z(a[0])},{menu:a[2]}];let o={};for(let e=0;e<n.length;e+=1)o=R(o,n[e]);return t=new Z({props:o}),t.$on("click",a[1]),{c(){y(t.$$.fragment)},m(e,s){T(t,e,s),i=!0},p(e,[s]){const f=s&13?ee(n,[s&8&&te(e[3]),s&1&&{data:e[0]},s&1&&{title:e[0].fileLabel},s&1&&{icon:z(e[0])},s&4&&{menu:e[2]}]):{};t.$set(f)},i(e){i||(v(t.$$.fragment,e),i=!0)},o(e){j(t.$$.fragment,e),i=!1},d(e){C(t,e)}}}var ye=globalThis&&globalThis.__awaiter||function(a,t,i,n){function o(e){return e instanceof i?e:new i(function(s){s(e)})}return new(i||(i=Promise))(function(e,s){function f(l){try{p(n.next(l))}catch(h){s(h)}}function m(l){try{p(n.throw(l))}catch(h){s(h)}}function p(l){l.done?e(l.value):o(l.value).then(f,m)}p((n=n.apply(a,t||[])).next())})};function K(a,t,i,n,o){return ye(this,void 0,void 0,function*(){const e={};let s;const f=yield L("files/load",{folder:"app:"+i,file:a+"."+t,format:"text"});ae({title:a,icon:o,tabComponent:n,tooltip:s,props:Object.assign({savedFile:a+"."+t,savedFolder:"app:"+i,savedFormat:"text",appFolder:i},e)},{editor:f})})}const Te=a=>a.fileName,ve=({fileName:a})=>t=>we.filterName(t,a),je={"config.json":"img json","command.sql":"img app-command","query.sql":"img app-query"};function z(a){return je[a.fileType]}function Ce(a,t,i){const n=["data"];let o=x(t,n);this&&this.__awaiter;let{data:e}=t;const s=()=>{W(G,{value:e.fileName,label:"New file name",header:"Rename file",onConfirm:_=>{L("apps/rename-file",{file:e.fileName,folder:e.folderName,fileType:e.fileType,newFile:_})}})},f=()=>{W(ie,{message:`Really delete file ${e.fileName}?`,onConfirm:()=>{L("apps/delete-file",{file:e.fileName,folder:e.folderName,fileType:e.fileType})}})},m=()=>{e.fileType.endsWith(".sql")&&p(),e.fileType.endsWith(".json")&&l()},p=()=>{K(e.fileName,e.fileType,e.folderName,"QueryTab","img sql-file")},l=()=>{K(e.fileName,e.fileType,e.folderName,"JsonEditorTab","img json")};function h(){return[{text:"Delete",onClick:f},{text:"Rename",onClick:s},e.fileType.endsWith(".sql")&&{text:"Open SQL",onClick:p},e.fileType.endsWith(".json")&&{text:"Open JSON",onClick:l}]}return a.$$set=_=>{t=R(R({},t),ne(_)),i(3,o=x(t,n)),"data"in _&&i(0,e=_.data)},[e,m,h,o]}class Fe extends P{constructor(t){super(),U(this,t,Ce,ge,Y,{data:0})}}const Se=Object.freeze(Object.defineProperty({__proto__:null,createMatcher:ve,default:Fe,extractKey:Te},Symbol.toStringTag,{value:"Module"}));function Ne(a){let t,i;return t=new _e({props:{icon:"icon refresh"}}),{c(){y(t.$$.fragment)},m(n,o){T(t,n,o),i=!0},p:H,i(n){i||(v(t.$$.fragment,n),i=!0)},o(n){j(t.$$.fragment,n),i=!1},d(n){C(t,n)}}}function qe(a){let t,i,n,o,e,s,f,m,p,l;function h(r){a[7](r)}let _={placeholder:"Search application files"};a[1]!==void 0&&(_.value=a[1]),t=new ce({props:_}),B.push(()=>D(t,"value",h));function N(r){a[8](r)}let w={};return a[1]!==void 0&&(w.filter=a[1]),o=new fe({props:w}),B.push(()=>D(o,"filter",N)),f=new pe({props:{icon:"icon plus-thick",menu:a[5]}}),p=new ue({props:{title:"Refresh files of selected application",$$slots:{default:[Ne]},$$scope:{ctx:a}}}),p.$on("click",a[4]),{c(){y(t.$$.fragment),n=O(),y(o.$$.fragment),s=O(),y(f.$$.fragment),m=O(),y(p.$$.fragment)},m(r,u){T(t,r,u),Q(r,n,u),T(o,r,u),Q(r,s,u),T(f,r,u),Q(r,m,u),T(p,r,u),l=!0},p(r,u){const $={};!i&&u&2&&(i=!0,$.value=r[1],J(()=>i=!1)),t.$set($);const g={};!e&&u&2&&(e=!0,g.filter=r[1],J(()=>e=!1)),o.$set(g);const c={};u&16384&&(c.$$scope={dirty:u,ctx:r}),p.$set(c)},i(r){l||(v(t.$$.fragment,r),v(o.$$.fragment,r),v(f.$$.fragment,r),v(p.$$.fragment,r),l=!0)},o(r){j(t.$$.fragment,r),j(o.$$.fragment,r),j(f.$$.fragment,r),j(p.$$.fragment,r),l=!1},d(r){r&&(M(n),M(s),M(m)),C(t,r),C(o,r),C(f,r),C(p,r)}}}function Ae(a){let t,i;return t=new de({props:{list:(a[3]||[]).map(a[9]),groupFunc:a[10],module:Se,filter:a[1]}}),{c(){y(t.$$.fragment)},m(n,o){T(t,n,o),i=!0},p(n,o){const e={};o&9&&(e.list=(n[3]||[]).map(n[9])),o&2&&(e.filter=n[1]),t.$set(e)},i(n){i||(v(t.$$.fragment,n),i=!0)},o(n){j(t.$$.fragment,n),i=!1},d(n){C(t,n)}}}function Le(a){let t,i,n,o;return t=new oe({props:{$$slots:{default:[qe]},$$scope:{ctx:a}}}),n=new se({props:{$$slots:{default:[Ae]},$$scope:{ctx:a}}}),{c(){y(t.$$.fragment),i=O(),y(n.$$.fragment)},m(e,s){T(t,e,s),Q(e,i,s),T(n,e,s),o=!0},p(e,[s]){const f={};s&16386&&(f.$$scope={dirty:s,ctx:e}),t.$set(f);const m={};s&16395&&(m.$$scope={dirty:s,ctx:e}),n.$set(m)},i(e){o||(v(t.$$.fragment,e),v(n.$$.fragment,e),o=!0)},o(e){j(t.$$.fragment,e),j(n.$$.fragment,e),o=!1},d(e){e&&M(i),C(t,e),C(n,e)}}}globalThis&&globalThis.__awaiter;const ke={"command.sql":"SQL commands","query.sql":"SQL queries"},Oe=`-- Write SQL command here
-- After save, you can execute it from database context menu, for all databases, which use this application
`,Qe=`-- Write SQL query here
-- After save, you can view it in tables list, for all databases, which use this application
`;function Me(a,t,i){let n,o,e,s,f=H,m=()=>(f(),f=me(o,c=>i(3,s=c)),o);re(a,he,c=>i(6,e=c)),a.$$.on_destroy.push(()=>f());var p=this&&this.__awaiter||function(c,F,b,d){function q(A){return A instanceof b?A:new b(function(k){k(A)})}return new(b||(b=Promise))(function(A,k){function V(S){try{E(d.next(S))}catch(I){k(I)}}function X(S){try{E(d.throw(S))}catch(I){k(I)}}function E(S){S.done?A(S.value):q(S.value).then(V,X)}E((d=d.apply(c,F||[])).next())})};let l="";const h=()=>{L("apps/refresh-files",{folder:n})};function _(c,F,b){W(G,{value:"",label:"New file name",header:F,onConfirm:d=>p(this,void 0,void 0,function*(){$e({title:d,initialData:b,savedFile:d+"."+c,savedFolder:"app:"+e,savedFormat:"text",appFolder:e})})})}function N(c,F){return p(this,void 0,void 0,function*(){(yield L("apps/create-config-file",{fileName:c,content:F,appFolder:e}))||be("File not created, probably already exists")})}function w(){return[{text:"New SQL command",onClick:()=>_("command.sql","Create new SQL command",Oe)},{text:"New SQL query",onClick:()=>_("query.sql","Create new SQL query",Qe)},{text:"New virtual references file",onClick:()=>N("virtual-references.config.json",[])},{text:"New dictionary descriptions file",onClick:()=>N("dictionary-descriptions.config.json",[])}]}function r(c){l=c,i(1,l)}function u(c){l=c,i(1,l)}const $=c=>({fileName:c.name,folderName:n,fileType:c.type,fileLabel:c.label}),g=c=>ke[c.fileType]||"App config";return a.$$.update=()=>{a.$$.dirty&64&&i(0,n=e),a.$$.dirty&1&&m(i(2,o=le({folder:n})))},[n,l,o,s,h,w,e,r,u,$,g]}class We extends P{constructor(t){super(),U(this,t,Me,Le,Y,{})}}export{We as default};
//# sourceMappingURL=AppFilesList-2bb90fc6.js.map
