import{S as N,i as O,s as S,aF as M,I as j,n as C,R as T,a3 as ee,Y as J,Q as p,P as V,O as f,aG as te,A as y,B as g,G as h,J as w,K as v,T as $,aH as q,aI as ne,D as A,aJ as le,aK as re,aL as ie,aM as B,C as D,aN as K,aO as se,c as oe,aP as ae,aQ as ce,aR as Q}from"./index-632e4f1b.js";import{_}from"./lodash-29c9ec56.js";import"./dbgate-datalib-0d3b84db.js";function ue(r){let e,n=r[0].map(r[1]).join(`
`)+"",t;return{c(){e=new ee(!1),t=M(),e.a=t},m(l,i){e.m(n,l,i),j(l,t,i)},p(l,[i]){i&1&&n!==(n=l[0].map(l[1]).join(`
`)+"")&&e.p(n)},i:C,o:C,d(l){l&&(T(t),e.d())}}}function fe(r,e,n){let{selection:t}=e;const l=i=>{const{value:o}=i;return _.isPlainObject(o)||_.isArray(o)?JSON.stringify(o,void 0,2):i.value};return r.$$set=i=>{"selection"in i&&n(0,t=i.selection)},[t,l]}class pe extends N{constructor(e){super(),O(this,e,fe,ue,S,{selection:0})}}function me(r){let e,n,t,l;return t=new te({props:{value:r[0],expanded:!0}}),{c(){e=y("div"),n=y("div"),g(t.$$.fragment),h(n,"class","inner svelte-qjn8rh"),h(e,"class","outer svelte-qjn8rh")},m(i,o){j(i,e,o),w(e,n),v(t,n,null),l=!0},p(i,o){const s={};o&1&&(s.value=i[0]),t.$set(s)},i(i){l||(f(t.$$.fragment,i),l=!0)},o(i){p(t.$$.fragment,i),l=!1},d(i){i&&T(e),$(t)}}}function de(r){let e,n;return e=new q({props:{message:"Error parsing JSON",alignTop:!0}}),{c(){g(e.$$.fragment)},m(t,l){v(e,t,l),n=!0},p:C,i(t){n||(f(e.$$.fragment,t),n=!0)},o(t){p(e.$$.fragment,t),n=!1},d(t){$(e,t)}}}function _e(r){let e,n,t,l;const i=[de,me],o=[];function s(a,c){return a[1]?0:1}return e=s(r),n=o[e]=i[e](r),{c(){n.c(),t=M()},m(a,c){o[e].m(a,c),j(a,t,c),l=!0},p(a,[c]){let d=e;e=s(a),e===d?o[e].p(a,c):(J(),p(o[d],1,1,()=>{o[d]=null}),V(),n=o[e],n?n.p(a,c):(n=o[e]=i[e](a),n.c()),f(n,1),n.m(t.parentNode,t))},i(a){l||(f(n),l=!0)},o(a){p(n),l=!1},d(a){a&&T(t),o[e].d(a)}}}function ge(r,e,n){let{selection:t}=e,{showWholeRow:l=!1}=e,i=null,o=null;return r.$$set=s=>{"selection"in s&&n(2,t=s.selection),"showWholeRow"in s&&n(3,l=s.showWholeRow)},r.$$.update=()=>{if(r.$$.dirty&12)try{if(l)(t==null?void 0:t.length)==1?n(0,i=t[0].rowData):n(0,i=t.map(s=>s.rowData));else{const s=t[0].value;n(0,i=_.isPlainObject(s)||_.isArray(s)?s:JSON.parse(s))}n(1,o=null)}catch(s){n(1,o=s.message)}},[i,o,t,l]}class Z extends N{constructor(e){super(),O(this,e,ge,_e,S,{selection:2,showWholeRow:3})}}function ve(r){let e,n;return e=new Z({props:{selection:r[0],showWholeRow:!0}}),{c(){g(e.$$.fragment)},m(t,l){v(e,t,l),n=!0},p(t,[l]){const i={};l&1&&(i.selection=t[0]),e.$set(i)},i(t){n||(f(e.$$.fragment,t),n=!0)},o(t){p(e.$$.fragment,t),n=!1},d(t){$(e,t)}}}function $e(r,e,n){let{selection:t}=e;return r.$$set=l=>{"selection"in l&&n(0,t=l.selection)},[t]}class we extends N{constructor(e){super(),O(this,e,$e,ve,S,{selection:0})}}function Y(r){let e,n,t,l,i,o;return t=new B({props:{isNative:!0,options:r[3].map(z),value:r[1]}}),t.$on("change",r[6]),i=new B({props:{isNative:!0,options:r[3].map(U),value:r[2]}}),i.$on("change",r[7]),{c(){e=y("div"),n=D(`Lat:
      `),g(t.$$.fragment),l=D(`
      Lon:
      `),g(i.$$.fragment)},m(s,a){j(s,e,a),w(e,n),v(t,e,null),w(e,l),v(i,e,null),o=!0},p(s,a){const c={};a&8&&(c.options=s[3].map(z)),a&2&&(c.value=s[1]),t.$set(c);const d={};a&8&&(d.options=s[3].map(U)),a&4&&(d.value=s[2]),i.$set(d)},i(s){o||(f(t.$$.fragment,s),f(i.$$.fragment,s),o=!0)},o(s){p(t.$$.fragment,s),p(i.$$.fragment,s),o=!1},d(s){s&&T(e),$(t),$(i)}}}function he(r){let e,n,t,l,i=r[3].length>=2&&Y(r);return t=new ne({props:{selection:r[0],latitudeField:r[1],longitudeField:r[2]}}),{c(){e=y("div"),i&&i.c(),n=A(),g(t.$$.fragment),h(e,"class","container svelte-aetkv7")},m(o,s){j(o,e,s),i&&i.m(e,null),w(e,n),v(t,e,null),l=!0},p(o,[s]){o[3].length>=2?i?(i.p(o,s),s&8&&f(i,1)):(i=Y(o),i.c(),f(i,1),i.m(e,n)):i&&(J(),p(i,1,1,()=>{i=null}),V());const a={};s&1&&(a.selection=o[0]),s&2&&(a.latitudeField=o[1]),s&4&&(a.longitudeField=o[2]),t.$set(a)},i(o){l||(f(i),f(t.$$.fragment,o),l=!0)},o(o){p(i),p(t.$$.fragment,o),l=!1},d(o){o&&T(e),i&&i.d(),$(t)}}}const z=r=>({label:r,value:r}),U=r=>({label:r,value:r});function be(r,e,n){let t,l,i,{selection:o}=e,s="",a="";const c=u=>{n(1,s=u.detail)},d=u=>{n(2,a=u.detail)};return r.$$set=u=>{"selection"in u&&n(0,o=u.selection)},r.$$.update=()=>{r.$$.dirty&1&&n(5,t=_.uniq(_.flatten(o.map(u=>le(u.rowData))))),r.$$.dirty&1&&n(4,l=_.uniq(_.flatten(o.map(u=>re(u.rowData))))),r.$$.dirty&1&&n(3,i=_.uniq(_.flatten(o.map(u=>ie(u.rowData))))),r.$$.dirty&42&&t.length>0&&!i.includes(s)&&n(1,s=t[0]),r.$$.dirty&28&&l.length>0&&!i.includes(a)&&n(2,a=l[0])},[o,s,a,i,l,t,c,d]}class ye extends N{constructor(e){super(),O(this,e,be,he,S,{selection:0})}}function ke(r){let e,n;return e=new q({props:{message:"Error showing picture",alignTop:!0}}),{c(){g(e.$$.fragment)},m(t,l){v(e,t,l),n=!0},p:C,i(t){n||(f(e.$$.fragment,t),n=!0)},o(t){p(e.$$.fragment,t),n=!1},d(t){$(e,t)}}}function Ce(r){let e,n,t;return{c(){e=y("div"),n=y("img"),K(n.src,t=r[0])||h(n,"src",t),h(e,"class","wrapper svelte-13i2vsu")},m(l,i){j(l,e,i),w(e,n)},p(l,i){i&1&&!K(n.src,t=l[0])&&h(n,"src",t)},i:C,o:C,d(l){l&&T(e)}}}function je(r){let e,n,t,l;const i=[Ce,ke],o=[];function s(a,c){return a[0]?0:1}return e=s(r),n=o[e]=i[e](r),{c(){n.c(),t=M()},m(a,c){o[e].m(a,c),j(a,t,c),l=!0},p(a,[c]){let d=e;e=s(a),e===d?o[e].p(a,c):(J(),p(o[d],1,1,()=>{o[d]=null}),V(),n=o[e],n?n.p(a,c):(n=o[e]=i[e](a),n.c()),f(n,1),n.m(t.parentNode,t))},i(a){l||(f(n),l=!0)},o(a){p(n),l=!1},d(a){a&&T(t),o[e].d(a)}}}function Te(r,e,n){let t;var l;let{selection:i}=e;function o(s){try{const a=s;return(a==null?void 0:a.type)=="Buffer"&&_.isArray(a==null?void 0:a.data)?"data:image/png;base64, "+btoa(String.fromCharCode.apply(null,a==null?void 0:a.data)):null}catch(a){return console.log("Error showing picture",a),null}}return r.$$set=s=>{"selection"in s&&n(1,i=s.selection)},r.$$.update=()=>{r.$$.dirty&6&&n(0,t=o(n(2,l=i[0])===null||l===void 0?void 0:l.value))},[t,i,l]}class Fe extends N{constructor(e){super(),O(this,e,Te,je,S,{selection:1})}}function Ne(r){let e,n;return{c(){e=y("textarea"),h(e,"class","flex1"),h(e,"wrap",r[1]),e.readOnly=!0,e.value=n=r[0].map(r[2]).join(`
`)},m(t,l){j(t,e,l)},p(t,[l]){l&2&&h(e,"wrap",t[1]),l&1&&n!==(n=t[0].map(t[2]).join(`
`))&&(e.value=n)},i:C,o:C,d(t){t&&T(e)}}}function Oe(r,e,n){let{selection:t}=e,{wrap:l}=e;const i=o=>{const{value:s}=o;return _.isPlainObject(s)||_.isArray(s)?JSON.stringify(s,void 0,2):o.value};return r.$$set=o=>{"selection"in o&&n(0,t=o.selection),"wrap"in o&&n(1,l=o.wrap)},[t,l,i]}class x extends N{constructor(e){super(),O(this,e,Oe,Ne,S,{selection:0,wrap:1})}}function Se(r){let e,n;return e=new x({props:{wrap:"no",selection:r[0]}}),{c(){g(e.$$.fragment)},m(t,l){v(e,t,l),n=!0},p(t,[l]){const i={};l&1&&(i.selection=t[0]),e.$set(i)},i(t){n||(f(e.$$.fragment,t),n=!0)},o(t){p(e.$$.fragment,t),n=!1},d(t){$(e,t)}}}function We(r,e,n){let{selection:t}=e;return r.$$set=l=>{"selection"in l&&n(0,t=l.selection)},[t]}class Pe extends N{constructor(e){super(),O(this,e,We,Se,S,{selection:0})}}function Je(r){let e,n;return e=new x({props:{wrap:"hard",selection:r[0]}}),{c(){g(e.$$.fragment)},m(t,l){v(e,t,l),n=!0},p(t,[l]){const i={};l&1&&(i.selection=t[0]),e.$set(i)},i(t){n||(f(e.$$.fragment,t),n=!0)},o(t){p(e.$$.fragment,t),n=!1},d(t){$(e,t)}}}function Ve(r,e,n){let{selection:t}=e;return r.$$set=l=>{"selection"in l&&n(0,t=l.selection)},[t]}class qe extends N{constructor(e){super(),O(this,e,Ve,Je,S,{selection:0})}}function Re(r){let e;return{c(){e=D("Cell data view")},m(n,t){j(n,e,t)},d(n){n&&T(e)}}}function Ae(r){var o;let e,n,t;var l=(o=r[2])==null?void 0:o.component;function i(s){return{props:{selection:s[0]}}}return l&&(e=Q(l,i(r))),{c(){e&&g(e.$$.fragment),n=M()},m(s,a){e&&v(e,s,a),j(s,n,a),t=!0},p(s,a){var d;const c={};if(a&1&&(c.selection=s[0]),a&4&&l!==(l=(d=s[2])==null?void 0:d.component)){if(e){J();const u=e;p(u.$$.fragment,1,0,()=>{$(u,1)}),V()}l?(e=Q(l,i(s)),g(e.$$.fragment),f(e.$$.fragment,1),v(e,n.parentNode,n)):e=null}else l&&e.$set(c)},i(s){t||(e&&f(e.$$.fragment,s),t=!0)},o(s){e&&p(e.$$.fragment,s),t=!1},d(s){s&&T(n),e&&$(e,s)}}}function De(r){let e,n;return e=new q({props:{message:"No data selected",alignTop:!0}}),{c(){g(e.$$.fragment)},m(t,l){v(e,t,l),n=!0},p:C,i(t){n||(f(e.$$.fragment,t),n=!0)},o(t){p(e.$$.fragment,t),n=!1},d(t){$(e,t)}}}function Le(r){let e,n;return e=new q({props:{message:"Format not selected",alignTop:!0}}),{c(){g(e.$$.fragment)},m(t,l){v(e,t,l),n=!0},p:C,i(t){n||(f(e.$$.fragment,t),n=!0)},o(t){p(e.$$.fragment,t),n=!1},d(t){$(e,t)}}}function Me(r){let e,n;return e=new q({props:{message:"Must be selected one cell",alignTop:!0}}),{c(){g(e.$$.fragment)},m(t,l){v(e,t,l),n=!0},p:C,i(t){n||(f(e.$$.fragment,t),n=!0)},o(t){p(e.$$.fragment,t),n=!1},d(t){$(e,t)}}}function Ee(r){let e,n,t,l,i,o,s,a,c,d,u,b,k,R;n=new se({props:{$$slots:{default:[Re]},$$scope:{ctx:r}}}),c=new B({props:{isNative:!0,value:r[1],options:[{value:"autodetect",label:`Autodetect - ${r[3].title}`},...L.map(X)]}}),c.$on("change",r[7]);const I=[Me,Le,De,Ae],W=[];function G(m,F){var P;return m[2].single&&((P=m[0])==null?void 0:P.length)!=1?0:m[2]==null?1:!m[0]||m[0].length==0?2:3}return b=G(r),k=W[b]=I[b](r),{c(){e=y("div"),g(n.$$.fragment),t=A(),l=y("div"),i=y("div"),o=D("Format:"),s=y("span"),s.textContent="Â ",a=A(),g(c.$$.fragment),d=A(),u=y("div"),k.c(),h(i,"class","toolbar svelte-1lvmq5c"),h(u,"class","data svelte-1lvmq5c"),h(l,"class","main svelte-1lvmq5c"),h(e,"class","wrapper svelte-1lvmq5c")},m(m,F){j(m,e,F),v(n,e,null),w(e,t),w(e,l),w(l,i),w(i,o),w(i,s),w(i,a),v(c,i,null),w(l,d),w(l,u),W[b].m(u,null),R=!0},p(m,[F]){const P={};F&256&&(P.$$scope={dirty:F,ctx:m}),n.$set(P);const E={};F&2&&(E.value=m[1]),F&8&&(E.options=[{value:"autodetect",label:`Autodetect - ${m[3].title}`},...L.map(X)]),c.$set(E);let H=b;b=G(m),b===H?W[b].p(m,F):(J(),p(W[H],1,1,()=>{W[H]=null}),V(),k=W[b],k?k.p(m,F):(k=W[b]=I[b](m),k.c()),f(k,1),k.m(u,null))},i(m){R||(f(n.$$.fragment,m),f(c.$$.fragment,m),f(k),R=!0)},o(m){p(n.$$.fragment,m),p(c.$$.fragment,m),p(k),R=!1},d(m){m&&T(e),$(n),$(c),W[b].d()}}}const L=[{type:"textWrap",title:"Text (wrap)",component:qe,single:!1},{type:"text",title:"Text (no wrap)",component:Pe,single:!1},{type:"json",title:"Json",component:Z,single:!0},{type:"jsonRow",title:"Json - Row",component:we,single:!1},{type:"picture",title:"Picture",component:Fe,single:!0},{type:"html",title:"HTML",component:pe,single:!1},{type:"map",title:"Map",component:ye,single:!1}];function He(r){var e,n,t;if(ae(r))return"map";if(!((t=(n=(e=r[0])===null||e===void 0?void 0:e.engine)===null||n===void 0?void 0:n.databaseEngineTypes)===null||t===void 0)&&t.includes("document"))return"jsonRow";const l=r.length==1?r[0].value:null;return _.isString(l)&&(l.startsWith("[")||l.startsWith("{"))||_.isPlainObject(l)||_.isArray(l)?"json":"textWrap"}let Be=null;const Ye=()=>Be,X=r=>({label:r.title,value:r.type});function Ie(r,e,n){let t,l,i,o,s;oe(r,ce,u=>n(6,s=u));let a="autodetect",{selection:c=void 0}=e;const d=u=>n(1,a=u.detail);return r.$$set=u=>{"selection"in u&&n(0,c=u.selection)},r.$$.update=()=>{r.$$.dirty&64&&n(0,c=s?s():[]),r.$$.dirty&1&&n(5,t=He(c)),r.$$.dirty&32&&n(3,l=L.find(u=>u.type==t)),r.$$.dirty&34&&n(4,i=a=="autodetect"?t:a),r.$$.dirty&16&&n(2,o=L.find(u=>u.type==i))},[c,a,o,l,i,t,s,d]}class ze extends N{constructor(e){super(),O(this,e,Ie,Ee,S,{selection:0})}}export{ze as default,Ye as getCellSelectionListener};
//# sourceMappingURL=CellDataWidget-a6df8f75.js.map
